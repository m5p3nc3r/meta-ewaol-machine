header:
  version: 11
  includes:
    - ewaol.yml

machine: raspberrypi4-64

repos:
  meta-raspberrypi:
    url: https://github.com/agherzan/meta-raspberrypi.git
    refspec: honister
    path: layers/meta-raspberrypi

local_conf_header:
  meta-raspberrypi: |
    # Always nice to have a serial console available :Â¬)
    ENABLE_UART = "1"
    RPI_EXTRA_CONFIG += "\ndtoverlay=disable-bt"

    # Hijack the CMDLINE_DEBUG to get the k3s cmdline requirements enabled
    # We could really do with an upstream friendly way of doing this.
    CMDLINE_DEBUG += " cgroup_memory=1 cgroup_enable=memory"

    RPI_USE_U_BOOT = "1"
    PREFERRED_PROVIDER_u-boot-default-script = "xen-rpi-u-boot-scr"
